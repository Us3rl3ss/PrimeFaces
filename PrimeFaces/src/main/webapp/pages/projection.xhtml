<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

<h:head>
</h:head>

<h:body>

	<ui:composition template="templates/common.xhtml">

		<ui:define name="content">

			<h:form id="projection">

				<p:panelGrid columns="5">

					<p:outputLabel for="theater" value="Kino:" />
					<p:selectOneMenu id="theater" value="#{projectionMB.theater}"
						converter="#{theaterConverter}">
						<f:selectItems value="#{projectionMB.theaterList}" var="theater"
							itemValue="#{theater}" itemLabel="#{theater.name}" />
						<f:ajax listener="#{projectionMB.search}" />
					</p:selectOneMenu>
					<p:outputLabel for="datumProjekcije" value="Datum:" />
					<p:calendar id="datumProjekcije" value="#{projectionMB.datumProjekcije}"
						pattern="dd.MM.yyyy" mask="true">
						<p:ajax event="dateSelect" listener="#{projectionMB.search}"/>
					</p:calendar>

					<p:commandButton value="Pretraži" action="#{projectionMB.search}"
						update="projection projection" />
						
				</p:panelGrid>

				<p:dataGrid var="projection" value="#{projectionMB.projectionList}"
					columns="3" layout="grid" rows="6" paginator="true" id="projection"
					paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
					rowsPerPageTemplate="6,12,16">
					
					 <p:panel header="#{projection.movie.name}" style="text-align:center">
				        
			            <h:panelGrid columns="2" style="width:100%">
			        
							<p:graphicImage value="#{movieImageMB.image}" width="100"
								height="150">
								<f:param value="#{projection.movie.id}" name="movie_id"></f:param>
							</p:graphicImage>
							
							<p:panel style="text-align:center">
							
								<h:panelGrid columns="2" style="width:100%">
			        
									<h:outputText value="Film:" />
									<h:outputText value="#{projection.movie.name}" />
									<h:outputText value="Godina: " />
									<h:outputText value="#{projection.movie.yearOfCreation}" />
									<h:outputText value="Trajanje:" />
									<h:outputText value="#{projection.movie.duration}" />
									<h:outputText value="Žanr:" />
									<h:outputText value="#{projection.movie.listOfGenresText}" />
										
								</h:panelGrid>
								
								<p:dataList value="#{projectionMB.doViewDistinctMovieProjections(projection)}"
									var="distinctProjection" type="unordered" itemType="none">
									
									<p:commandLink action="#{projectionMB.doViewReserveSeats}"
										title="View Detail" styleClass="ui-icon ui-icon-search"
										style="float:left;margin-right:10px">
										<f:setPropertyActionListener value="#{distinctProjection}"
											target="#{projectionMB.projection}" />
										<h:outputText
											value="#{distinctProjection.numberOfFreeSeatsText}, #{distinctProjection.startTime}, #{distinctProjection.cinema.numberOfSeats}, #{distinctProjection.cinema.name}" />
									</p:commandLink>
		
									<h:outputText value="#{distinctProjection.startTime}">
										<f:convertDateTime pattern="HH:mm" />
									</h:outputText>
		
									<h:outputText
										value=", #{distinctProjection.cinema.name} (#{distinctProjection.numberOfFreeSeatsText})">
									</h:outputText>
		
								</p:dataList>
								
					        </p:panel>
								
						</h:panelGrid>
						
			        </p:panel>

				</p:dataGrid>

			</h:form>

		</ui:define>

	</ui:composition>

</h:body>
</html>